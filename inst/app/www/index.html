<!DOCTYPE html>
<html>

  <head>
    <title>Excalidraw in browser</title>
    <meta charset="UTF-8" />
    <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>

    <script type="text/javascript" src="https://unpkg.com/@excalidraw/excalidraw/dist/excalidraw.development.js"></script>
  </head>

<body>
  <div>
    <div id="app"></div>
  </div>
  <script>
    var excalidrawRef;
  const App = () => {

    excalidrawRef = React.useRef(null);
        return React.createElement(
          React.Fragment,
          null,
          React.createElement(
            "div",
            {
              style: { height: "100vh" },
            },
            React.createElement(ExcalidrawLib.Excalidraw, {
              ref: excalidrawRef,
              initialData: {{ initialData }},
              onChange: (elements, state) => {
                try {
                    Shiny.setInputValue("{{id_for_shiny}}",
                    ExcalidrawLib.serializeAsJSON(
                      element = excalidrawRef.current.getSceneElements(),
                      appState = excalidrawRef.current.getAppState(),
                      file = excalidrawRef.current.getFiles()
                    )
                    );
                  } catch {
                    console.log("nop")
                  }

              },
            }),
          ),
        );
      };

      const excalidrawWrapper = document.getElementById("app");
      const root = ReactDOM.createRoot(excalidrawWrapper);
      root.render(React.createElement(App));
  </script>
</body>

</html>